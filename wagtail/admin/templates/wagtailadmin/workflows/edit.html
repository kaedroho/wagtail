{% extends "wagtailadmin/base.html" %}
{% load i18n wagtailadmin_tags %}

{% block titletag %}{{ view.get_meta_title }}{% endblock %}

{% block extra_css %}
    {% include "wagtailadmin/pages/_editor_css.html" %}
    {{ edit_handler.form.media.css }}
    {{ pages_formset.media.css }}

    {{ view.media.css }}
    <link rel="stylesheet" href="{% versioned_static 'wagtailadmin/css/layouts/workflow-edit.css' %}" type="text/css" />
{% endblock %}

{% block extra_js %}
    {% include "wagtailadmin/pages/_editor_js.html" %}
    {{ edit_handler.form.media.js }}
    {{ pages_formset.media.js }}
    {{ edit_handler.html_declarations }}

    {{ view.media.js }}
{% endblock %}

{% block content %}

    {% include "wagtailadmin/shared/header.html" with title=view.page_title icon=view.header_icon merged=1 %}

    <ul class="tab-nav merged">
        <li class="active"><a href="#workflow">{% trans "Workflow" %}</a></li>
        <li><a href="#pages">{% trans "Pages" %}</a></li>
    </ul>

    <form action="{% block form_action %}{{ view.edit_url }}{% endblock %}"{% if is_multipart %} enctype="multipart/form-data"{% endif %} method="POST" novalidate>
        <div class="tab-content">
            {% csrf_token %}

            <section id="workflow" class="active">
                {% block form %}{{ edit_handler.render_form_content }}{% endblock %}
            </section>
            <section id="pages" class="nice-padding">
                {% include "wagtailadmin/workflows/includes/workflow_pages_formset.html" with formset=pages_formset %}
            </section>
        </div>

        <div class="object">
            <ul class="object-layout">
                <li class="object-layout_big-part">
                    <p class="actions">
                        <button type="submit" class="button action-save button-longrunning" data-clicked-text="{% trans 'Savingâ€¦' %}">
                            <span class="icon icon-spinner"></span><em>{% trans 'Save' %}</em>
                        </button>
                    </p>
                </li>
            </ul>
        </div>
    </form>

    {% if can_enable or can_disable %}
        <div class="nice-padding">
            <form action="{{ view.get_enable_url }}" method="POST" novalidate>
                {% csrf_token %}
                <p class="actions">
                    {% if can_enable %}
                        <button type="submit" class="button button-secondary no">{{ view.enable_item_label }}</button>
                    {% endif %}
                    {% if can_disable %}
                        <a href="{{ view.get_delete_url }}" class="button button-secondary no">{{ view.delete_item_label }}</a>
                    {% endif %}
                </p>
            </form>
        </div>
    {% endif %}
{% endblock %}
